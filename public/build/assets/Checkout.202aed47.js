import{_ as y}from"./AppLayout.dc6e3cfa.js";import{ac as b,bk as _,aZ as v,aS as r,af as e,bm as i,bE as m,bC as u,ae as l,ad as k,aX as x,a1 as w,al as d,_ as c}from"./runtime-dom.esm-bundler.585c24df.js";import{_ as I}from"./_plugin-vue_export-helper.cdc0426e.js";import{u as C}from"./app.f1de3385.js";import"./ResponsiveNavLink.baeb7a52.js";import"./NavLink.0007d28d.js";/* empty css            */const P={props:{user:Object},data(){return{orderItems:{},form:C({address:null,delivery_type:"home",name:this.user.name,email:this.user.email,phone:this.user.phone}),loading:!1,checkoutId:null}},methods:{makePayment(){this.loading=!0;let n={phone:this.form.phone,amount:Math.round(this.orderItems.grand_total),invoice_no:this.orderItems.invoice_no,email:this.form.email,delivery_type:this.form.delivery_type,address:this.form.address,name:this.form.name};window.axios.post(route("make.mpesa.payment"),n).then(o=>{console.log(o.data.status),this.checkoutId=o.data.checkoutId,o.data.status===200&&(Swal.fire({title:o.data.message,icon:"success",timerProgressBar:!1,showConfirmButton:!0,confirmButtonText:"Confirm Payment"}).then(a=>{a.isConfirmed?this.checkPaymentStatus(o.data.checkoutId):a.isDenied&&Swal.fire("Changes are not saved","","info")}),this.loading=!1)})},registerurl(){window.axios.post(route("register.urls")).then(n=>{console.log(n)})},checkPaymentStatus(n){let o={checkoutId:n};window.axios.post(route("confirm.payment"),o).then(a=>{console.log(a),a.data.data.status===1?(Swal.fire({title:"Payment confirmed Successfully",icon:"success",timerProgressBar:!0,showConfirmButton:!1}),window.location.href=route("myorders")):a.data.data.status===0&&Swal.fire({title:"Payment not confirmed",icon:"warning",timerProgressBar:!1,showConfirmButton:!0,confirmButtonText:"Confirm Payment"}).then(h=>{h.isConfirmed&&this.checkPaymentStatus(this.checkoutId)})})}},mounted(){window.axios.get(route("get.orders",localStorage.getItem("orderItemready"))).then(n=>{this.orderItems=n.data.order})},components:{AppLayout:y}},S=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Checkout ",-1),B={class:"py-12"},E={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},V={class:"row"},N={class:"col-sm-8"},T={class:"bg-white p-8"},U=e("div",{class:"row"},[e("div",{class:"col-12"},[e("h4",null,"Billing Infomation")])],-1),A={class:"row mb-3"},D={class:"col-sm-12"},L=e("label",{for:"name"},"Name",-1),M={class:"row mb-3"},K={class:"col-sm-6"},j=e("label",{for:"email"},"Email",-1),F={class:"col-sm-6"},H=e("label",{for:"phone"},[d("Phone Number"),e("small",{class:"text-red-600"},"*")],-1),O=e("div",{class:"row mb-3"},[e("div",{class:"col-12"},[e("label",{for:"",class:"mb-2"},[d("Choose where we should deliver your order "),e("small",{class:"text-red-600"},"*")])])],-1),R={class:"row mb-3"},X={class:"col-4"},Z={class:"items-center pl-4 rounded border-2 border-gray-200 focus:border-green-600 peer-checked:text-green-600 hover:text-gray-600 hover:bg-gray-200 ring-green-600"},q=e("label",{for:"home",class:"py-4 ml-2 w-full text-sm font-medium text-gray-900"},"Deliver at Home",-1),z={class:"col-sm-4"},G={class:"items-center pl-4 rounded border-2 border-gray-200 peer-checked:border-green-600 peer-checked:text-green-600 hover:text-gray-600 hover:bg-gray-200 ring-green-600"},J=e("label",{for:"school",class:"py-4 ml-2 w-full text-sm font-medium text-gray-900"},"Deliver at School ",-1),Q={class:"col-4"},W={class:"items-center pl-4 rounded border-2 border-gray-200 peer-checked:border-green-600 peer-checked:text-green-600 hover:text-gray-600 hover:bg-gray-200 ring-green-600"},Y=e("label",{for:"pickup",class:"py-4 ml-2 w-full text-sm font-medium text-gray-900"},"I want to pick it myself",-1),$={key:0},ee={for:"message",class:"block mb-2 text-sm font-medium text-gray-900"},oe={key:0},te={key:1},se={key:2},re={class:"col-sm-4"},ne={class:"bg-gray-50 p-8"},le=e("h4",null,"Order Infomation",-1),ae=e("h5",null,"Books",-1),ie=e("hr",null,null,-1),de={class:"pl-0 mb-4"},ce={class:"flex mb-2",style:{"max-height":"230px"}},me={class:"h-16 w-16 mr-2"},ue=["src","alt"],he=e("br",null,null,-1),ge=e("strong",null,"Price: ",-1),_e=e("hr",null,null,-1),fe=e("strong",null,"Sub total",-1),pe=e("strong",null,"Tax charged",-1),ye=e("strong",null,"Total",-1),be={class:"mt-5"},ve={key:0,class:"flex"},ke=e("div",{class:"spinner-border",role:"status"},null,-1),xe=e("span",{class:"ml-2"},"Please wait, Loading...",-1),we=[ke,xe],Ie={key:1};function Ce(n,o,a,h,t,g){const f=v("AppLayout");return r(),b(f,{title:"Checkout"},{header:_(()=>[S]),default:_(()=>[e("div",B,[e("div",E,[e("div",V,[e("div",N,[e("div",T,[U,e("div",A,[e("div",D,[L,i(e("input",{id:"name",type:"text",class:"form-control","onUpdate:modelValue":o[0]||(o[0]=s=>t.form.name=s)},null,512),[[m,t.form.name]])])]),e("div",M,[e("div",K,[j,i(e("input",{id:"email",type:"text",class:"form-control","onUpdate:modelValue":o[1]||(o[1]=s=>t.form.email=s)},null,512),[[m,t.form.email]])]),e("div",F,[H,i(e("input",{id:"phone",type:"text",class:"form-control","onUpdate:modelValue":o[2]||(o[2]=s=>t.form.phone=s),placeholder:"Mpesa Phone number to pay from "},null,512),[[m,t.form.phone]])])]),O,e("div",R,[e("div",X,[e("div",Z,[i(e("input",{id:"home",type:"radio",value:"home",name:"delivery_type","onUpdate:modelValue":o[3]||(o[3]=s=>t.form.delivery_type=s),class:"w-4 h-4 text-green-600 bg-gray-100 border-gray-300 focus:ring-green-500 dark:focus:ring-green-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[u,t.form.delivery_type]]),q])]),e("div",z,[e("div",G,[i(e("input",{id:"school",type:"radio",value:"school",name:"delivery_type","onUpdate:modelValue":o[4]||(o[4]=s=>t.form.delivery_type=s),class:"w-4 h-4 text-green-600 bg-gray-100 border-gray-300 focus:ring-green-500 dark:focus:ring-green-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[u,t.form.delivery_type]]),J])]),e("div",Q,[e("div",W,[i(e("input",{id:"pickup",type:"radio",value:"pickup",name:"delivery_type","onUpdate:modelValue":o[5]||(o[5]=s=>t.form.delivery_type=s),class:"w-4 h-4 text-green-600 bg-gray-100 border-gray-300 focus:ring-green-500 dark:focus:ring-green-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[u,t.form.delivery_type]]),Y])])]),t.form.delivery_type?(r(),l("div",$,[e("label",ee,[t.form.delivery_type==="home"?(r(),l("span",oe,"Enter Home Address below")):t.form.delivery_type==="school"?(r(),l("span",te,"Enter Name of the School, Student, Admission Number, Class & Address below")):(r(),l("span",se,"Enter Name of the City/Town you are in"))]),i(e("textarea",{id:"message","onUpdate:modelValue":o[6]||(o[6]=s=>t.form.address=s),rows:"6",class:"block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-green-500 focus:border-green-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-green-500 dark:focus:border-green-500",placeholder:"add more information on where we should deliver the order ..."},null,512),[[m,t.form.address]])])):k("",!0)])]),e("div",re,[e("div",ne,[le,ae,ie,e("ul",de,[(r(!0),l(w,null,x(t.orderItems.order_items,(s,p)=>(r(),l("li",{key:p},[e("div",ce,[e("div",me,[e("img",{src:s.product.featured_image,alt:s.product.name,class:"w-full h-full object-cover"},null,8,ue)]),e("p",null,[e("strong",null,c(s.product.name),1),he,e("span",null,[ge,d("KES "+c(s.amount),1)])])])]))),128))]),_e,e("div",null,[e("p",null,[fe,d(" KES "+c(t.orderItems.sub_total),1)]),e("p",null,[pe,d(" KES "+c(parseInt(t.orderItems.grand_total-t.orderItems.sub_total)),1)]),e("p",null,[ye,d(" KES "+c(t.orderItems.grand_total),1)]),e("div",be,[e("button",{class:"text-decoration-none px-6 py-3 hover:bg-green-400 font-semibold rounded-md bg-gray-600 text-white",onClick:o[7]||(o[7]=(...s)=>g.makePayment&&g.makePayment(...s))},[t.loading?(r(),l("div",ve,we)):(r(),l("span",Ie,"Make Payment"))])])])])])])])])]),_:1})}const Ue=I(P,[["render",Ce]]);export{Ue as default};
